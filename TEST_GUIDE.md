# 🧪 راهنمای تست قبل از Deploy

## 🎯 هدف
تست کردن تغییرات جدید bot قبل از اینکه روی server اصلی deploy شود.

## 🔧 پیش‌نیازها

### 1️⃣ Bot جدید برای تست بسازید
1. به [@BotFather](https://t.me/BotFather) بروید
2. دستور `/newbot` بفرستید  
3. اسم bot: `Farsi Dutch Test Bot`
4. Username: `farsi_dutch_test_bot` (یا نام دیگری که available باشد)
5. **Token را کپی کنید**

### 2️⃣ فایل .env.test را تنظیم کنید
```properties
# در فایل .env.test 
TELEGRAM_BOT_TOKEN=TOKEN_JADID_INJA_BEZARID
CLAUDE_API_KEY=CLAUDE_API_KEY_SHOMA_INJA
NODE_ENV=test
KEEP_ALIVE_ENABLED=false
```

## 🚀 مراحل تست

### مرحله 1: اجرای Bot تست
```bash
# در terminal اجرا کنید:
.\test-bot.bat

# یا:
set NODE_ENV=test && node bot.js
```

### مرحله 2: تست ویژگی‌های جدید
در تلگرام، bot تست خود را پیدا کنید و این موارد را تست کنید:

#### 🔤 **تست سیستم انتخاب هوشمند:**
1. `/start` کنید
2. روی دکمه **🌐 ترجمه** بزنید
3. چند کلمه هلندی ترجمه کنید:
   - `huis` 
   - `auto`
   - `boek`
   - `water`
   - `school`

#### 🎯 **تست سیستم تست جدید:**
1. روی دکمه **📝 تست** بزنید
2. ببینید کلمه جدیدترین (آخری) انتخاب می‌شود؟
3. به سوال پاسخ دهید
4. روی **⏭️ سوال بعدی** بزنید - کلمه وسط انتخاب شود
5. دوباره **⏭️ سوال بعدی** - کلمه قدیمی‌ترین انتخاب شود

#### 🚪 **تست کنترل تست:**
1. روی **🚪 خروج از تست** بزنید
2. باید به منو اصلی برگردد
3. تست جدید شروع کنید - باید session ریست شده باشد

#### 📊 **تست آمار:**
1. روی **📊 آمار من** بزنید
2. آمار کلمات و تست‌ها نمایش داده شود

### مرحله 3: تست تکرار نکردن
1. تست‌های متوالی شروع کنید
2. ببینید آیا کلمات تکرار می‌شوند تا همه استفاده شوند
3. پس از استفاده از همه کلمات، session باید ریست شود

## ✅ نتیجه تست
اگر همه موارد بالا کار کرد:

### 🎉 تست موفق - آماده Deploy:
```bash
# 1. تغییرات را commit کنید:
git add .
git commit -m "Improved test word selection system"

# 2. Push کنید:  
git push origin master

# 3. Server خودکار به‌روزرسانی خواهد شد
```

### ❌ مشکل دارد - Debug کنید:
1. لاگ‌های terminal را بررسی کنید
2. مشکل را برطرف کنید  
3. دوباره تست کنید
4. بعد از حل مشکل، deploy کنید

## 🔄 پس از Deploy
1. Bot تست را خاموش کنید (Ctrl+C)
2. Bot اصلی را در تلگرام تست کنید
3. اطمینان یابید همه چیز کار می‌کند

## ⚠️ نکات مهم
- **هرگز token های اصلی را در .env.test نگذارید**
- **Bot تست را فقط برای تست استفاده کنید**
- **قبل از deploy حتماً تست کنید**
- **.env.test را به git اضافه نکنید** (در .gitignore است)

---
*آخرین به‌روزرسانی: ۲۶ سپتامبر ۲۰۲۵*